
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Account signatures and keys &#8212; Web3 Foundation Research  documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/stylesheets/extra.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"extensions": ["tex2jax.js"], "jax": ["input/TeX", "output/HTML-CSS"], "tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "displayMath": [["$$", "$$"], ["\\[", "\\]"]], "processEscapes": true}, "HTML-CSS": {"fonts": ["TeX"]}})</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Account signatures and keys in Polkadot" href="1-accounts-more.html" />
    <link rel="prev" title="Polkadot’s cryptography" href="index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="account-signatures-and-keys">
<h1>Account signatures and keys<a class="headerlink" href="#account-signatures-and-keys" title="Permalink to this headline">¶</a></h1>
<div class="section" id="ristretto">
<h2>Ristretto<a class="headerlink" href="#ristretto" title="Permalink to this headline">¶</a></h2>
<p>We believe Polkadot accounts should primarily use Schnorr signatures with both public keys and the <code class="docutils literal notranslate"><span class="pre">R</span></code> point in the signature encoded using the <a class="reference external" href="https://ristretto.group">Ristretto</a> point compression for the Ed25519 curve.  We should collaborate with the <a class="reference external" href="https://github.com/dalek-cryptography">dalek ecosystem</a> for which Ristretto was developed, but provide a simpler signature crate, for which <a class="reference external" href="https://github.com/w3f/schnorr-dalek">schnorr-dalek</a> provides a first step.</p>
<p>I’ll write a another comment giving more details behind this choice, but the high level summary goes:</p>
<p>Account keys must support the diverse functionality desired of account keys on other systems like Ethereum and Bitcoin.  As such, our account keys shall use Schnorr signatures because these support fast batch verification and hierarchical deterministic key derivation ala <a class="reference external" href="https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki#Child_key_derivation_CKD_functions">BIP32</a>. All features from the <a class="reference external" href="https://github.com/sipa/bips/blob/bip-schnorr/bip-schnorr.mediawiki">Bitcoin Schnoor wishlist</a> provides a case for Schnorr signatures matter too, like</p>
<ul class="simple">
<li><p>interactive threshold and multi-signaturtes, as well as</p></li>
<li><p>adaptor, and perhaps even blind, signatures for swaps and payment channels. </p></li>
</ul>
<p>We make conservative curve choices here because account keys must live for decades.  In particular, we avoid pairing-based cryptography and BLS signatures for accounts, at the cost of true aggregation of the signatures in a block when verifying blocks, and less interactive threshold and multi-signaturtes. [1]. </p>
<p>In the past, there was a tricky choice between the more secure curves:</p>
<ul class="simple">
<li><p>miss-implementation resistance is stronger with Edwards curves, including the Ed25519 curve, but</p></li>
<li><p>miss-use resistance in stronger when curves have cofactor 1, like secp256k1.</p></li>
</ul>
<p>In fact, miss-use resistance was historically a major selling point for Ed25519, which itself is a Schnorr variant, but this miss-use resistance extends only so far as the rudimentary signature scheme properties it provided.  Yet, any advanced signature scheme functions, beyond batch verification, break precisely due to Ed25519’s miss-use resistance.  In fact, there are tricks for doing at least hierarchical deterministic key derivation on Ed25519, as implemented in <a class="reference external" href="https://github.com/w3f/hd-ed25519">hd-ed25519</a>, but almost all previous efforts <a class="reference external" href="https://forum.web3.foundation/t/key-recovery-attack-on-bip32-ed25519/44">produced insecure results</a>.</p>
<p>We observe that secp256k1 provides a good curve choice from among the curves of cofactor 1, which simplify make implementing fancier protocols.  We do worry that such curves appear at least slightly weaker than Edwards curves.   We worry much more than such curves tend to be harder to implement well, due to having incomplete addition formulas, and thus require more review (see <a class="reference external" href="https://safecurves.cr.yp.to">safecurves.cr.yp.to</a>).  We could select only solid implementations for Polkadot itself, but we cannot control the implementations selected elsewhere in our ecosystem, especially by wallet software.</p>
<p>In short, we want an Edwards curve but without the cofactor, which do not exist, except..</p>
<p>In Edwards curve of with cofactor 4, <a class="reference external" href="https://www.shiftleft.org/papers/decaf/">Mike Hamburg’s Decaf point compression</a> only permits serialising and deserialising points on the subgroup of order <span class="math notranslate nohighlight">\(l\)</span>, which provides a perfect solution.  <a class="reference external" href="https://ristretto.group">Ristretto</a> pushes this point compression to cofactor 8, making it applicable to the Ed25519 curve.  Implementations exist in both <a class="reference external" href="https://doc.dalek.rs/curve25519_dalek/ristretto/index.html">Rust</a> and <a class="reference external" href="https://github.com/Ristretto/libristretto255">C</a>.  If required in another language, the compression and decompression functions are reasonable to implement using an existing field implementation, and fairly easy to audit.  </p>
<p>In the author’s words, “Rather than bit-twiddling, point mangling, or otherwise kludged-in ad-hoc fixes, Ristretto is a thin layer that provides protocol implementors with the correct abstraction: a prime-order group.”</p>
</div>
<div class="section" id="additional-signature-types">
<h2>Additional signature types<a class="headerlink" href="#additional-signature-types" title="Permalink to this headline">¶</a></h2>
<p>We could support multiple signature schemes for accounts, preferably with each account supporting only one single signature scheme, and possessing only one public key.  There are at least three or four additional signature types worth considering:</p>
<p>We could support Ed25519 itself so as to improve support for HSMs, etc.  It’s security is no different from Ristretto Schnorr signatures for normal use cases.  We’ve provided a secure HDKD solution, but users might encounter problems from existing tools that provide HDKD solutions.</p>
<p>At least initially, we have allocated dots to secp256k1 keys compatible with ECDSA signatures on Ethereum.  We could use Schnorr / EdDSA signatures with these same keys instead.  We could however restrict these keys to doing only outgoing transfers, with the hope that they disappear completely without the first six months.  We might alternatively keep secp256k1 key support long term in the hopes that either the secp vs secq duality proves useful, or that parties with legacy infrastructure like exchanges benefit.</p>
<p>We might develop a delinearized variant of the proof-of-possesion based mBCJ signatures from pages 21 and 22 of https://eprint.iacr.org/2018/417.pdf which provide two-round trip multi-signatures.  All current Schnorr multi-signature schemes require three round trips.  See https://github.com/w3f/schnorrkel/issues/15  I’d expect such a delinearized variant of mBCJ to use Ristretto keys too, but the signature scheme differs.</p>
<p>We could support BLS12-381 signatures to provide true signature aggregation.  We could even integrate these with how session keys appear on-chain, but we’ve currently no argument for doing this.</p>
<hr class="docutils" />
<p>[1] Aggregation can dramatically reduce signed message size when applying numerous signatures, but if performance is the only goal then batch verification techniques similar results, and exist for mny signature schemes, including Schnorr.  There are clear advantages to reducing interactiveness in threshold and multi-signaturtes, but parachains can always provide these on Polkadot.  Importantly, there are numerous weaknesses in all known curves that support pairings, but the single most damning weakness is the pairing <span class="math notranslate nohighlight">\(e : G_1 \times G_2 \to G_T\)</span> itself.    In essence, we use elliptic curves in the first palce because they insulate us somewhat from mathematicians ever advancing understanding of number theory.  Yet, any known pairing maps into a group <span class="math notranslate nohighlight">\(G_T\)</span> that re-exposes us, so attacks based on index-calculus, etc. improve more quickly.  As a real world example, there were weaknesses found in BN curve of the sort used by ZCash during development, so after launch they needed to develop and migrate to a <a class="reference external" href="https://z.cash/blog/new-snark-curve/">new curve</a>.  We expect this to happen again for roughly the same reasons that RSA key sizes increase slowly over time.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">Web3 Foundation Research</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../polkadot.html">Polkadot</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html">Polkadot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Availability_and_Validity.html">Availability and Validity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../GRANDPA.html">GRANDPA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ICMP.html">ICMP Scheme</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Parachain-Allocation.html">Parachain Allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Polkadot-Runtime-Environment.html">Polkadot Runtime Environment Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Token Economics.html">Token Economics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../BABE.html">BABE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../NPoS.html">NPoS</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../keys.html">Keys</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="index.html">Polkadot’s cryptography</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Account signatures and keys</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ristretto">Ristretto</a></li>
<li class="toctree-l4"><a class="reference internal" href="#additional-signature-types">Additional signature types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="1-accounts-more.html">Account signatures and keys in Polkadot</a></li>
<li class="toctree-l3"><a class="reference internal" href="2-staking.html">Nomination</a></li>
<li class="toctree-l3"><a class="reference internal" href="3-session.html">Session keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="4-secio.html">Transport layer authentication - libp2p’s SECIO</a></li>
<li class="toctree-l3"><a class="reference internal" href="creation.html">Account key creation ideas for Polkadot</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../networking.html">Networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../slashing.html">Slashing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../research_team_members.html">Research Team Members</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../../polkadot.html">Polkadot</a><ul>
  <li><a href="../keys.html">Keys</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Polkadot’s cryptography</a></li>
      <li>Next: <a href="1-accounts-more.html" title="next chapter">Account signatures and keys in Polkadot</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Web3 Foundation.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
      |
      <a href="../../_sources/polkadot/keys/1-accounts.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>