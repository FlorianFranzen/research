
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="">
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Token Economics &#8212; Research at W3F</title>
    <link rel="stylesheet" href="../_static/material.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/stylesheets/extra.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"extensions": ["tex2jax.js"], "jax": ["input/TeX", "output/HTML-CSS"], "tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "displayMath": [["$$", "$$"], ["\\[", "\\]"]], "processEscapes": true}, "HTML-CSS": {"fonts": ["TeX"]}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="BABE" href="BABE.html" />
    <link rel="prev" title="Polkadot Runtime Environment Specification" href="Polkadot-Runtime-Environment.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=deep-orange data-md-color-accent=deep-orange>
  <svg class="md-svg">
    <defs data-children-count="0">
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448"
           id="__github">
        <path fill="currentColor"
              d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"></path>
      </svg>
    </defs>
  </svg>
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#polkadot/Token Economics" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="Research at W3F"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/w3f_logo.svg" height="26"
                   alt="Research at W3F logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Research at W3F</span>
          <span class="md-header-nav__topic"> Token Economics </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Research at W3F</a></li>
          <li class="md-tabs__item"><a href="../polkadot.html" class="md-tabs__link">Polkadot</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="Research at W3F" class="md-nav__button md-logo">
      
        <img src="../_static/w3f_logo.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="Research at W3F">Research at W3F</a>
  </label>
  

  
  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <a href="../polkadot.html" class="md-nav__link">Polkadot</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
      <a href="index.html" class="md-nav__link">Polkadot</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="Availability_and_Validity.html" class="md-nav__link">Availability and Validity</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="GRANDPA.html" class="md-nav__link">GRANDPA</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="ICMP.html" class="md-nav__link">ICMP Scheme</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="Parachain-Allocation.html" class="md-nav__link">Parachain Allocation</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="Polkadot-Runtime-Environment.html" class="md-nav__link">Polkadot Runtime Environment Specification</a>
      
    </li>
    <li class="md-nav__item">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Token Economics </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Token Economics</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#polkadot-token-economics--page-root" class="md-nav__link">Token Economics</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#introduction" class="md-nav__link">Introduction</a>
        </li>
        <li class="md-nav__item"><a href="#organization" class="md-nav__link">Organization</a>
        </li>
        <li class="md-nav__item"><a href="#npos-payments-and-inflation" class="md-nav__link">NPoS payments and inflation</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#inflation-model" class="md-nav__link">Inflation model</a>
        </li>
        <li class="md-nav__item"><a href="#payment-details" class="md-nav__link">Payment details</a>
        </li>
        <li class="md-nav__item"><a href="#distribution-of-payment-within-a-validator-slot" class="md-nav__link">Distribution of payment within a validator slot</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#relay-chain-transaction-fees-and-per-block-transaction-limits" class="md-nav__link">Relay-chain transaction fees and per-block transaction limits</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#limits-on-resource-usage" class="md-nav__link">Limits on resource usage</a>
        </li>
        <li class="md-nav__item"><a href="#setting-transaction-fees" class="md-nav__link">Setting transaction fees</a>
        </li>
        <li class="md-nav__item"><a href="#adjustment-of-fees-over-time" class="md-nav__link">Adjustment of fees over time</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#-1.-fast-adjusting-mechanism" class="md-nav__link">1. Fast adjusting mechanism</a>
        </li>
        <li class="md-nav__item"><a href="#-2.-slow-adjusting-mechanism" class="md-nav__link">2. Slow adjusting mechanism</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#treasury" class="md-nav__link">Treasury</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/polkadot/Token Economics.md.txt">Show Source</a> </li>

  </ul>
</nav><ul class="md-nav__list"> 
    <li class="md-nav__item">
    
      <a href="#introduction" class="md-nav__link">Introduction</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="#organization" class="md-nav__link">Organization</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="#npos-payments-and-inflation" class="md-nav__link">NPoS payments and inflation</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
      <a href="#inflation-model" class="md-nav__link">Inflation model</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="#payment-details" class="md-nav__link">Payment details</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="#distribution-of-payment-within-a-validator-slot" class="md-nav__link">Distribution of payment within a validator slot</a>
      
    </li></ul>
    </li>
    <li class="md-nav__item">
    
      <a href="#relay-chain-transaction-fees-and-per-block-transaction-limits" class="md-nav__link">Relay-chain transaction fees and per-block transaction limits</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
      <a href="#limits-on-resource-usage" class="md-nav__link">Limits on resource usage</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="#setting-transaction-fees" class="md-nav__link">Setting transaction fees</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="#adjustment-of-fees-over-time" class="md-nav__link">Adjustment of fees over time</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
      <a href="#-1.-fast-adjusting-mechanism" class="md-nav__link">1. Fast adjusting mechanism</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="#-2.-slow-adjusting-mechanism" class="md-nav__link">2. Slow adjusting mechanism</a>
      
    </li></ul>
    </li></ul>
    </li>
    <li class="md-nav__item">
    
      <a href="#treasury" class="md-nav__link">Treasury</a>
      
    </li></ul>
    </li>
    <li class="md-nav__item">
    
      <a href="BABE.html" class="md-nav__link">BABE</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="NPoS.html" class="md-nav__link">NPoS</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="keys.html" class="md-nav__link">Keys</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="networking.html" class="md-nav__link">Networking</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="slashing.html" class="md-nav__link">Slashing</a>
      
    </li></ul>
    </li>
    <li class="md-nav__item">
    
      <a href="../research_team_members.html" class="md-nav__link">Research Team Members</a>
      
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#polkadot-token-economics--page-root" class="md-nav__link">Token Economics</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#introduction" class="md-nav__link">Introduction</a>
        </li>
        <li class="md-nav__item"><a href="#organization" class="md-nav__link">Organization</a>
        </li>
        <li class="md-nav__item"><a href="#npos-payments-and-inflation" class="md-nav__link">NPoS payments and inflation</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#inflation-model" class="md-nav__link">Inflation model</a>
        </li>
        <li class="md-nav__item"><a href="#payment-details" class="md-nav__link">Payment details</a>
        </li>
        <li class="md-nav__item"><a href="#distribution-of-payment-within-a-validator-slot" class="md-nav__link">Distribution of payment within a validator slot</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#relay-chain-transaction-fees-and-per-block-transaction-limits" class="md-nav__link">Relay-chain transaction fees and per-block transaction limits</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#limits-on-resource-usage" class="md-nav__link">Limits on resource usage</a>
        </li>
        <li class="md-nav__item"><a href="#setting-transaction-fees" class="md-nav__link">Setting transaction fees</a>
        </li>
        <li class="md-nav__item"><a href="#adjustment-of-fees-over-time" class="md-nav__link">Adjustment of fees over time</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#-1.-fast-adjusting-mechanism" class="md-nav__link">1. Fast adjusting mechanism</a>
        </li>
        <li class="md-nav__item"><a href="#-2.-slow-adjusting-mechanism" class="md-nav__link">2. Slow adjusting mechanism</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#treasury" class="md-nav__link">Treasury</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/polkadot/Token Economics.md.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <p>====================================================================</p>
<p><strong>Authors</strong>: Alfonso Cevallos, Fatemeh Shirazi (minor)</p>
<p><strong>Last updated</strong>: 19.11.2019</p>
<p>====================================================================</p>

<h1 id="polkadot-token-economics--page-root">Token Economics<a class="headerlink" href="#polkadot-token-economics--page-root" title="Permalink to this headline">¶</a></h1>
<p>Polkadot will have a native token called DOT. Its main functions are as follows:</p>
<ol class="simple">
<li><p>Economics: Polkadot will mint or burn DOTs in order to reward the nodes that run the consensus protocol, to fund the treasury, to control the inflation rate, etc.</p></li>
<li><p>Slashing: DOTs also play a role in the slashing protocols designed to desincentivize attacks or adversarial behaviors.</p></li>
<li><p>Governance: DOTs are also used as voting power, to let DOT holders express their opinion in governance decisions via referenda.</p></li>
<li><p>Parachain allocation: Finally, DOTs are used to decide which projects are allocated a parachain slot, via auctions and deposits. </p></li>
</ol>
<p>In this section we focus on the first use above, while each of the other three uses is analyzed in a separate section. </p>

<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Polkadot is a proof-of-stake based platform where a set of validators, who have staked DOTs, produce blocks and reach consensus.  If a validator steers away from the protocol, some of his DOTs are slashed, but otherwise he gets paid for their contribution (roughly) proportional to his staked DOTs. The set of nodes elected as validators changes constantly (in each era, i.e. around once a day), but the number remains limited. However, any number of DOT holders can also participate indirectly in the decision-making processes as <em>nominators</em>, in what we call <em>nominated proof-of-stake</em>. A nominator indicates which validator candidates she trusts, and puts some DOTs at stake to support her nomination. If one or more of her nominated candidates are elected as validators in an era, she shares with them any economical rewards or punishments, proportional to her stake. Being a nominator is a way of investing one’s DOTs, and of helping in the security of the system. Indeed, the larger the total amount of DOTs staked by nominators and validators, the higher the system security, because an adversary needs that much more stake – or nominators’ trust – before it gets any nodes elected as validators. </p>
<p>We therefore aim at having a considerable percentage of the total DOT supply be staked by validators and nominators. Another large percentage of the DOT supply will be frozen as deposits by the commercial blockchains who get a parachain slot. We originally aim to have around 50% of DOTs staked in NPoS, and 30% in parachain deposits. As a reference, the percentage staked in other PoS-based projects is as follows.
- Tezos is 65.73% staked
- DASH is 58.69% staked
- Lisk is 58.20% staked
- EOS is only 35.49% staked, but that is because it is DPoS and the yield is low.</p>


<h2 id="organization">Organization<a class="headerlink" href="#organization" title="Permalink to this headline">¶</a></h2>
<p>This note contains the following subsections.</p>
<ul class="simple">
<li><p><strong>NPoS payment and inflation:</strong> We describe how we reward well-behaving validators and nominators in our nominated proof-of-stake. Since the DOT minting for this end is the main cause of inflation in the system, we also describe our inflation model here.</p></li>
<li><p><strong>Transaction fees:</strong> We analyse the optimal transaction fees on the relay chain to cover for costs, discourage harmful behaviors, and handle eventual peaks of activity and long inclusion times.</p></li>
<li><p><strong>Treasury:</strong> We discuss how and when to raise DOTs to pay for the continued maintenance of the network.</p></li>
</ul>
<p>Finally, in the last paragraph of the note we provide links to additional relevant references about the Polkadot protocol.</p>


<h2 id="npos-payments-and-inflation">NPoS payments and inflation<a class="headerlink" href="#npos-payments-and-inflation" title="Permalink to this headline">¶</a></h2>
<p>We consider here payments to validators and nominators for their participation in the protocols of block production (BABE) and finality (GRANDPA). We consider only the payments coming from minting new tokens, in normal circumstances. In particular we do not consider slashings, rewards to misconduct reporters and fishermen, or rewards from transaction fees. These will be considered in other sections.</p>
<p>As these payments are the main driver of inflation in the system, we first study our inflation model.</p>

<h3 id="inflation-model">Inflation model<a class="headerlink" href="#inflation-model" title="Permalink to this headline">¶</a></h3>
<p>Let <span class="math notranslate nohighlight">\(x\)</span> be the <em>staking rate</em> in NPoS at a particular point in time, i.e. the total amount of tokens staked by nominators and validators, divided by the total token supply. <span class="math notranslate nohighlight">\(x\)</span> is always a value between 0 and 1.</p>
<p><strong>Adjustable parameter:</strong> Let <span class="math notranslate nohighlight">\(\chi_{ideal}\)</span> be the staking rate we would like to attain ideally in the long run. This value should probably lie between 0.3 and 0.6, and we originally set it at \chi_{ideal}=0.546 If it falls, the security is compromised, so we should give strong incentives to DOT holders to stake more. If it rises, we lose liquidity, which is also undesirable, so we should decrease the incentives sharply.</p>
<p>Let <span class="math notranslate nohighlight">\(i=i(x)\)</span> be the yearly <em>interest rate</em> in NPoS; i.e., the total yearly amount of tokens minted to pay all validators and nominators for block production and Grandpa, divided by the total amount of tokens staked by them. We consider it as a function of <span class="math notranslate nohighlight">\(x\)</span>. Intuitively, <span class="math notranslate nohighlight">\(i(x)\)</span> corresponds to the incentive we give people to stake. Hence, <span class="math notranslate nohighlight">\(i(x)\)</span> should be a monotone decreasing function of <span class="math notranslate nohighlight">\(x\)</span>, as less incentive is needed when <span class="math notranslate nohighlight">\(x\)</span> increases.</p>
<ul class="simple">
<li><p>We study the yearly interest rate (instead of the interest rate per block or per epoch) for ease of comprehension. This means that <span class="math notranslate nohighlight">\(i(x)\)</span> is the total payout perceived by somebody that continuously stakes one DOT during a year. The interest rate per block can be easily computed from it. <strong>(Q: do we consider compound interest in this computation? In other words, can the staked parties immediately reinvest their payment into stake?)</strong></p></li>
<li><p>Not every staked party will be paid proportional to their stake. For instance, a validator will be paid more than a nominator with equal stake, and a validator producing a block will be temporarily paid more than a validator not producing a block. So, <span class="math notranslate nohighlight">\(i(x)\)</span> only works as a guide of the average interest rate.</p></li>
</ul>
<p><strong>Adjustable parameter:</strong> Let <span class="math notranslate nohighlight">\(i_{ideal}:=i(\chi_{ideal})\)</span> be the interest rate we pay in the ideal scenario where <span class="math notranslate nohighlight">\(x=\chi_{ideal}\)</span>. This is the interest rate we should be paying most of the time. We suggest the value <span class="math notranslate nohighlight">\(i_{ideal}=0.2\)</span>, i.e. an ideal yearly interest rate of 20%.</p>
<p>Let <span class="math notranslate nohighlight">\(I\)</span> be the yearly <em>inflation rate</em>; i.e.</p>
<div class="math notranslate nohighlight">
\[I=\frac{\text{token supply at end of year} - \text{token supply at begining of year}}{\text{token supply at begining of year}}.\]</div>
<p>The inflation rate is given by</p>
<div class="math notranslate nohighlight">
\[I=I_{NPoS}+I_{treasury}-I_{slashing} - I_{tx-fees},\]</div>
<p>where <span class="math notranslate nohighlight">\(I_{NPoS}\)</span> is the inflation caused by token minting to pay nominators and validators, <span class="math notranslate nohighlight">\(I_{treasury}\)</span> is the inflation caused by minting for treasury, <span class="math notranslate nohighlight">\(I_{slashing}\)</span> is the deflation caused by burning following a misconduct, and <span class="math notranslate nohighlight">\(I_{tx-fees}\)</span> is the deflation caused by burning transaction fees.</p>
<ul class="simple">
<li><p>The rewards perceived by block producers from transaction fees (and tips) do not come from minting, but from tx senders. Similarly, the rewards perceived by reporters and fishermen for detecting a misconduct do not come from minting but from the slashed party. This is why these terms do not appear in the formula above.</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(I_{NPoS}\)</span> should be by far the largest of these amounts, and thus the main driver of overall inflation. Notice that by channelling all of the tokens destined to burning -due to both slashing and transaction fees- into treasury, we decrease the other terms in the formula (see the section on treasury). If we consider <span class="math notranslate nohighlight">\(I_{NPoS}\)</span> as a function of the staking rate <span class="math notranslate nohighlight">\(x\)</span>, then clearly the relation between <span class="math notranslate nohighlight">\(I_{NPoS}(x)\)</span> and <span class="math notranslate nohighlight">\(i(x)\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[I_{NPoS}(x)=x\cdot i(x).\]</div>
<p>From our previous analysis, we can see that <span class="math notranslate nohighlight">\(I_{NPoS}(\chi_{ideal})=\chi_{ideal}\cdot i_{ideal}\)</span>. Since we want to steer the market toward a staking rate of <span class="math notranslate nohighlight">\(x=\chi_{ideal}\)</span>, it makes sense that the inflation rate <strong><span class="math notranslate nohighlight">\(I_{NPoS}(x)\)</span> should be maximal at this value</strong>.</p>
<p><strong>Adjustable parameter:</strong> Let <span class="math notranslate nohighlight">\(I_0\)</span> be the limit of <span class="math notranslate nohighlight">\(I_{NPoS}(x)\)</span> as <span class="math notranslate nohighlight">\(x\)</span> goes to zero (i.e. when neither validators nor nominators are staking any DOTs). The value of <span class="math notranslate nohighlight">\(I_0\)</span> shoud be close to zero but not zero, because we need to make sure to always cover at least the operational costs of the validators, even if nominators get paid nothing. Hence, <span class="math notranslate nohighlight">\(I_0\)</span> represents an estimate of the operational costs of all validators, expressed as a fraction of the total token supply. We will make sure that <span class="math notranslate nohighlight">\(I_{NPoS}(x)\)</span> is always above <span class="math notranslate nohighlight">\(I_0\)</span> for all values of <span class="math notranslate nohighlight">\(x\)</span>, in particular also in the limit when <span class="math notranslate nohighlight">\(x\)</span> goes to one.</p>
<p>For simplicity, we propose that the inflation function grow linearly between <span class="math notranslate nohighlight">\(x=0\)</span> and <span class="math notranslate nohighlight">\(x=\chi_{ideal}\)</span>. On the other hand, we propose that it decay exponentially between <span class="math notranslate nohighlight">\(x=\chi_{ideal}\)</span> and <span class="math notranslate nohighlight">\(x=1\)</span>. We choose an exponential decrease for <span class="math notranslate nohighlight">\(I_{NPoS}(x)\)</span> because this implies an exponential decrease for <span class="math notranslate nohighlight">\(i(x)\)</span> as well, and we want the interest rate to fall sharply beyond <span class="math notranslate nohighlight">\(\chi_{ideal}\)</span> to avoid illiquidity, while still being able to control its rate of change, <span class="math notranslate nohighlight">\(i(x+\varepsilon)/i(x)\)</span>, when <span class="math notranslate nohighlight">\(x\)</span> increases by a small amount <span class="math notranslate nohighlight">\(\varepsilon\)</span>. Bounding how fast the interest rate changes is important for the nominators and validators.</p>
<p><strong>Adjustable parameter:</strong> Define the <em>decay rate</em><span class="math notranslate nohighlight">\(d\)</span> so that the inflation rate decreases by at most 50% when <span class="math notranslate nohighlight">\(x\)</span> shifts <span class="math notranslate nohighlight">\(d\)</span> units to the right of <span class="math notranslate nohighlight">\(\chi_{ideal}\)</span>, i.e. <span class="math notranslate nohighlight">\(I_{NPoS}(\chi_{ideal} + d) \geq I_{NPoS}/2\)</span>. We suggest <span class="math notranslate nohighlight">\(d=0.05\)</span>.</p>
<p>From the previous discussion, we propose the following interest rate and inflation rate functions, which depend on the parameters <span class="math notranslate nohighlight">\(\chi_{ideal}\)</span>, <span class="math notranslate nohighlight">\(i_{ideal}\)</span>, <span class="math notranslate nohighlight">\(I_0\)</span> and <span class="math notranslate nohighlight">\(d\)</span>. Let</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
I_{NPoS}(x) &amp;= \begin{cases}
I_0 + x\Big(i_{ideal} - \frac{I_0}{\chi_{ideal}}\Big)
&amp;\text{for } 0&lt;x\leq \chi_{ideal}\\
I_0 + (i_{ideal}\cdot \chi_{ideal} - I_0)\cdot 2^{(\chi_{ideal}-x)/d}
&amp;\text{for } \chi_{ideal} &lt; x \leq 1
\end{cases}, \text{ and}\\
\\
i(x)&amp;= I_{NPoS}(x)/x.
\end{align}\end{split}\]</div>
<p>It can be checked that <span class="math notranslate nohighlight">\(I_{NPoS}\geq I_0\)</span> for all <span class="math notranslate nohighlight">\(0\leq x \leq 1\)</span> with equality for <span class="math notranslate nohighlight">\(x=0\)</span>, <span class="math notranslate nohighlight">\(i(\chi_{ideal})=i_{ideal}\)</span>, <span class="math notranslate nohighlight">\(I_{NPoS}(x)\)</span> is maximal at <span class="math notranslate nohighlight">\(x=\chi_{ideal}\)</span> where it achieves a value of <span class="math notranslate nohighlight">\(\chi_{ideal}\cdot i_{ideal}\)</span>, and <span class="math notranslate nohighlight">\(i(x)\)</span> is monotone decreasing.</p>
<p>These functions can be plotted for different parameters following this link: https://www.desmos.com/calculator/2om7wkewhr</p>
<p>As an example, when <span class="math notranslate nohighlight">\(I_0=0.025\)</span>, <span class="math notranslate nohighlight">\(\chi_{ideal}=0.5\)</span>, <span class="math notranslate nohighlight">\(i_{ideal}=0.2\)</span> and <span class="math notranslate nohighlight">\(d=0.05\)</span>, we obtain the following plots, with <span class="math notranslate nohighlight">\(i(x)\)</span> in green and <span class="math notranslate nohighlight">\(I_{NPoS}(x)\)</span> in blue.</p>
<p><img alt="https://i.imgur.com/Kk1MLJH.png" src="https://i.imgur.com/Kk1MLJH.png"/></p>


<h3 id="payment-details">Payment details<a class="headerlink" href="#payment-details" title="Permalink to this headline">¶</a></h3>
<p>There are several protocols that honest validators are involved in, and we reward their successful participation or slash their lack thereof (whichever is easier to detect). From this point of view, we decide to reward validators (and their nominators) only for <em>validity checking</em> and for <em>block production</em>, because they are easy to detect.</p>
<p>In the branch of validity checking, we reward:</p>
<ul class="simple">
<li><p>a parachain validator for each validity statement of the parachain block that it issues.</p></li>
</ul>
<p>In the branch of block production, we reward:</p>
<ul class="simple">
<li><p>the block producer for producing a (non-uncle) block in the relay chain,</p></li>
<li><p>the block producer for each reference to a previously unreferenced uncle, and</p></li>
<li><p>the producer of each referenced uncle block.</p></li>
</ul>
<p>These are thus considered “payable actions”. We define a point system where a validator earns a certain amount of points for each payable action executed, and at the end of each era they are paid proportional to their earned points. (The exact DOT value of each point is not known in advance because it depends on the total number of points earned by all validators in a given era. This is because we want the total payout per era to depend on the inflation model established above, and not on the number of payable actions executed). </p>
<p><strong>Adjustable parameters:</strong> We propose the following point system: </p>
<ul class="simple">
<li><p>20 points for each validity statement,</p></li>
<li><p>20 points for each (non-uncle) block produced,</p></li>
<li><p>2 points (to the block producer) for each reference to a previously unreferenced uncle, and</p></li>
<li><p>1 point to the producer of each referenced uncle.</p></li>
</ul>
<p>Notice that what is important here is not the absolute points but the point ratios, which establish the reward ratios of the payable actions. These points are parameters to be adjusted by governance. </p>
<p>In each era <span class="math notranslate nohighlight">\(e\)</span>, and for each validator <span class="math notranslate nohighlight">\(v\)</span>, we keep a counter <span class="math notranslate nohighlight">\(c_v^e\)</span> on the number of points earned by <span class="math notranslate nohighlight">\(v\)</span>. Let <span class="math notranslate nohighlight">\(c^e = 
\sum_{\text{validators } v} c_v^e\)</span> be the total number of points earned by all validators in era <span class="math notranslate nohighlight">\(e\)</span>, and let <span class="math notranslate nohighlight">\(P^e_{NPoS}\)</span> be our target total payout to all validators – and their nominators – in that era (see previous section on inflation model to see how to establish <span class="math notranslate nohighlight">\(P^e_{NPoS}\)</span>). Then, at the end of era <span class="math notranslate nohighlight">\(e\)</span>, the payout corresponding to validator <span class="math notranslate nohighlight">\(v\)</span> and his nominators is given by </p>
<div class="math notranslate nohighlight">
\[\frac{c_v^e}{c^e} \cdot P^e_{NPoS}.\]</div>
<p>We remark that we can also use the counters to combat unresponsiveness: if a validator has earned close to zero points in payable actions during an era (or any other period of time being measured), we kick them out. See the note on Slashings for more details.</p>


<h3 id="distribution-of-payment-within-a-validator-slot">Distribution of payment within a validator slot<a class="headerlink" href="#distribution-of-payment-within-a-validator-slot" title="Permalink to this headline">¶</a></h3>
<p>In any given era, the stake of a nominator <span class="math notranslate nohighlight">\(n\)</span> is typically distributed among several validators, e.g. 70% of <span class="math notranslate nohighlight">\(n\)</span>’s stake is assigned to validator 1, 20% to validator 2, 10% to validator 3, etc. This distribution is decided automatically by the NPoS validator election mechanism that runs at the beginning of each era (see notes on NPoS for details). </p>
<p>If there are <span class="math notranslate nohighlight">\(m\)</span> validators, then this stake distribution partitions the global stake pool into <span class="math notranslate nohighlight">\(m\)</span> slots: one per validator. The stake in each validator slot is comprised of 100% of that validator’s stake, and some fraction (possibly zero) of the stake of each nominator that approved of the validator. We sometimes refer to a validator’s stake as “self-stake”, to distinguish it from the <em>validator slot’s stake</em>, which is typically much larger. In the previous subsection we explained how the payouts are assigned to each validator slot in a given era. In this subsection, we explain how this payout is distributed within a slot, i.e. among the validator and the nominators in it. Ultimately, a nominator’s payout in a given era corresponds to the sum of her payouts with respect to each slot that contains some of her stake.</p>
<p>We remark that, since none of the nominators or validators can individually control the above-mentioned stake partition into validator slots (which is decided automatically by the validator election mechanism) or the exact payouts (which depend on global parameters such as the staking rate), none of the participants knows in advance exactly how much reward they will get during an era. In the future, we might allow nominators to specify their desired interest rates. We block this feature for the time being to simplify the corresponding optimization problem that the validator election mechanism solves.</p>
<p>We also remark that our mechanism takes as much of the nominators’ available stake as possible; i.e. if a nominator has at least one of her approved validators elected, all of her available stake will be used. The idea is that the more stake, the more security we have. In contrast, we follow the policy that validator slots are paid equally for equal work, and they are NOT paid proportional to their stakes. So if a validator slot A has less stake than another validator slot B, then the parties in A are paid more per staked DOT. This should motivate nominators to rapidly adjust their preferences in future eras, to favor less popular validators, so that we can achieve a more balanced distribution of stake across validator slots (which is one of the main objectives of the validator election mechanism; see notes on NPoS for more details). This should also help new validator candidates have a better chance to get elected, which is important to ensure decentralization.</p>
<p>Within a validator slot, the payment is as follows: First, validator <span class="math notranslate nohighlight">\(v\)</span> is paid his “commission fee”, which is an amount entirely up to <span class="math notranslate nohighlight">\(v\)</span> to decide, and which is publicly announced in advance by him, before nominators reveal their votes for the era. This fee is intended to cover <span class="math notranslate nohighlight">\(v\)</span>’s operational costs. Then, the remainder is shared among all parties (i.e. <span class="math notranslate nohighlight">\(v\)</span> and the nominators) proportional to their stake within the validator slot. In other words, when it comes to payment, validator <span class="math notranslate nohighlight">\(v\)</span> is considered as two entities: a non-staked validator that is rewarded a fixed commission fee, and a staked nominator that is treated like any other nominator and rewarded pro rata. Notice that a higher commission fee set by the validator means a higher total payout for him and a lower payout to his nominators, but since this fee is publicly known in advance, nominators will prefer to back validators with low fees (all else being equal). We thus let the market regulate itself. On one hand, a validator candidate with a high commission fee risks not getting enough votes to be elected as validator. On the other hand, validators who have built a strong reputation of being reliable and high performing will likely get away with charging a higher fee (which is fair), as they will still be preferred over other validators. And for a nominator, supporting riskier validators will be correlated with more rewards (which makes sense).</p>



<h2 id="relay-chain-transaction-fees-and-per-block-transaction-limits">Relay-chain transaction fees and per-block transaction limits<a class="headerlink" href="#relay-chain-transaction-fees-and-per-block-transaction-limits" title="Permalink to this headline">¶</a></h2>
<p>Some of the properties we want to achieve relative to relay-chain transactions are as follows:</p>
<ol class="simple">
<li><p>Each relay-chain block should be processed efficiently, even on less powerful nodes, to avoid delays in block production.</p></li>
<li><p>The growth rate of the relay chain state is bounded. 2’. Better yet if the absolute size of the relay chain state is bounded.</p></li>
<li><p>Each block has <em>guaranteed availability</em> for a certain amount of operational, high-priority txs such as misconduct reports.</p></li>
<li><p>Blocks are typically far from full, so that peaks of activity can be dealt with effectively and long inclusion times are rare.</p></li>
<li><p>Fees evolve slowly enough, so that the fee of a particular tx can be predicted accurately within a frame of a few minutes.</p></li>
<li><p>For any tx, its fee level is strictly larger than the reward perceived by the block producer for processing it. Otherwise, the block producer is incentivized to stuff blocks with fake txs.</p></li>
<li><p>For any tx, the processing reward perceived by the block producer is high enough to incentivize tx inclusion, yet low enough not to incentivize a block producer to create a fork and steal the transactions of the previous block. Effectively, this means that that the marginal reward perceived for including an additional tx is higher than the corresponding marginal cost of processing it, yet the total reward for producing a full block is not much larger than the reward for producing an empty block (even when tips are factored in).</p></li>
</ol>
<p>For the time being, we focus on satisfying properties 1 through 6 (without 2’), and we leave properties 2’ and 7 for a further update. We also need more analysis on property 2.</p>
<p>The amount of transactions that are processed in a relay-chain block can be regulated in two ways: by imposing limits, and by adjusting the level of tx fees. We ensure properties 1 through 3 above by imposing hard limits on resource usage, while properties 4 through 6 are achieved via fee adjustments. These two techniques are presented in the following two subsections respectively.</p>

<h3 id="limits-on-resource-usage">Limits on resource usage<a class="headerlink" href="#limits-on-resource-usage" title="Permalink to this headline">¶</a></h3>
<p>We identify four resources which can be consumed when processing a tx:</p>
<ul class="simple">
<li><p>Length: data size of the tx in bytes within the relay-chain block,</p></li>
<li><p>Time: time it takes to import it (i/o and cpu),</p></li>
<li><p>Memory: amount of memory it takes when processing,</p></li>
<li><p>State: amount of state storage increase it induces.</p></li>
</ul>
<p>Notice that unlike the other three resources which are consumed only once, state storage has a permanent cost over the network. Hence for state storage we could have rent or other Runtime mechanisms, to better match fees with the true cost of a tx, and ensure the state size remains bounded. This needs further consideration. We could also consider a mechanism that doesn’t impose a hard limit on state increase but rather controls it via fees; however we prefer to add a limit for soundness, in order to avoid edge cases where the state grows out of control.</p>
<p><strong>Adjustable parameters.</strong> For the time being, we suggest the following limits on resource usage when processing a block. These parameters are to be further adjusted via governance based on real-life data or more sophisticated mechanisms. </p>
<ul class="simple">
<li><p>Length: 5MB</p></li>
<li><p>Time: 2 seconds</p></li>
<li><p>Memory: 10 GB</p></li>
<li><p>State: 1 MB increase </p></li>
</ul>
<p>In principle, a tx consumes some amount of the last three resources depending on its length, type, input arguments, and current state. However, for simplicity we decided to consider, for each transaction type, only the worst-case state, and only the byte length of its input arguments. Consequently, we classify transactions based on length, type and argument length, and run tests (based on worst-case state) to examine their typical resource usage. </p>
<p>For the time being, we are considering a model where every transaction within a block is processed in sequence. So, in order to ensure the block memory bound above, it is sufficient to ensure that each tx observes the memory bound. We make sure this is the case. However, in the future we may consider parallelism. </p>
<p>To simplify our model further, we define a tx <em>weight</em> as a parameter that captures the time usage and state increase of a tx. Specifically, we define a tx weight as the <em>max</em> of its typical time and state usage, each measured as a fraction of the corresponding block limit. Then, given a collection of txs, we will sum up their lengths on one hand, and their weights on the other hand, and we will allow them within the same block only if both limits are respected. This is a hard constraint on resource usage which must be respected in each block.</p>
<p>We add a further constraint on resource usage. We distinguish between “normal” txs and “operational” txs, where the latter type corresponds to high-priority txs such a fisherman reports. A collection of normal txs is allowed within the same block only if both their sum of lengths and their sum of weights are below 75% of the respective limits. This is to ensure that each block has a guaranteed space for operational txs (at least 25% of resources). </p>
<p><strong>Details about establishing typical resource usage for txs.</strong> Length is easy to determine by inspection. For time and memory usage, we prepare the chain with the worst-case state (the state for which the time and memory requirements to import this tx type should be the largest). We generate 10k transactions for a given transaction type with input which should take the longest to import for that state, and we measure the mean and standard deviation for the resource usage with the Wasm environment. If the standard deviation is greater than 10% of the mean, we increase the sample space above 10k. Finally, state increase is by inspection, based on worst cases for a large sample of txs.</p>


<h3 id="setting-transaction-fees">Setting transaction fees<a class="headerlink" href="#setting-transaction-fees" title="Permalink to this headline">¶</a></h3>
<p>We use the model described above to set the fee level of a tx based on three parameters: the tx type, its length, and its weight (parameters defined in the previous subsection). This fee differentiation is used to reflect the different costs in resources incurred per transaction, and to encourage/discourage certain tx market behaviors.</p>
<p>As mentioned earlier, part of the tx fee needs to go to the block producer, to incentivize inclusion, but not all of it, so the block producer is discouraged from stuffing blocks with bogus txs. For simplicity, we originally suggest that 20% of each tx fee goes to the block producer, with the remaining 80% going to treasury. We remark that a fraction could also be set for burning, but we choose not to do so to keep better control of the inflation rate. In the future this percentage may be adjusted, and could be made dependent on the tx type, to encourage the block producer to include certain tx types without necessarily adjusting the fee.</p>
<p>A transaction fee tx is computed as follows:</p>
<div class="math notranslate nohighlight">
\[fee(tx) = c_{traffic} \cdot \Big[ base\_fee + type(tx)\cdot length(tx) + weight(tx)\Big],\]</div>
<p>where <span class="math notranslate nohighlight">\(c_{traffic}\)</span> is a parameter independent from the transaction, that evolves over time depending on the network traffic; we explain this parameter in the next subsection. Parameter <span class="math notranslate nohighlight">\(type(tx)\)</span> depends on the transaction type only; in particular for operational transactions, we currently set <span class="math notranslate nohighlight">\(type(tx)\)</span> to zero.</p>
<p>Intuitively, the term <span class="math notranslate nohighlight">\(weight(tx)\)</span> covers the processing cost of the block producer, while the term <span class="math notranslate nohighlight">\(type(tx) \cdot length(tx)\)</span> covers the opportunity cost of processing one transaction instead of another one in a block. </p>


<h3 id="adjustment-of-fees-over-time">Adjustment of fees over time<a class="headerlink" href="#adjustment-of-fees-over-time" title="Permalink to this headline">¶</a></h3>
<p>The demand for transactions is typically quite irregular on blockchains. On one hand, there are peaks of activity at the scale of hours within a day or days within a month. On the other hand, there are long term tendencies. We need a mechanism that automatically updates the transaction fees over time taking these factors into consideration. By the law of supply and demand, raising the fee should decrease the demand, and vice-versa.</p>
<p>To deal with peaks of activity, we face a trade-off between hiking up transaction fees rapidly or potentially having long transaction inclusion times - both undesirable effects. We propose two mechanisms. The first one adjusts the price very quickly, at the same pace as the peaks and valleys of activity. The second one adjusts slowly, at the pace of long term tendencies, and uses tipping to give users the possibility of controlling waiting times at peak hours. We propose to use the slow adjusting mechanism with tips, but provide details of both mechanisms for completeness.</p>

<h4 id="-1.-fast-adjusting-mechanism">1. Fast adjusting mechanism<a class="headerlink" href="#-1.-fast-adjusting-mechanism" title="Permalink to this headline">¶</a></h4>
<p>In this mechanism the transaction fees vary greatly through time, but are fixed for all users at each block (no tipping).</p>
<p>Recall that we set a hard limit on the sum of lengths and weights of all transactions allowed on a block. We also set a second hard limit, this time on the sum of lengths and weights of “normal” txs (non-operational txs), which is equal to 75% of the first limit. </p>
<p><strong>Definition.</strong> We define a block’s saturation level (relative to normal txs) as a fraction <span class="math notranslate nohighlight">\(s\)</span> between 0 and 1 which describes how close the limit on normal txs is from being full. Explicitly, the saturation level of a block <span class="math notranslate nohighlight">\(B\)</span> is</p>
<div class="math notranslate nohighlight">
\[s(B):=\max\{\frac{\sum_{\text{normal } tx \in B} length(tx)}{\text{normal length limit}}, \frac{\sum_{\text{normal } tx \in B} weight(tx)}{\text{normal weight limit}}\},\]</div>
<p>where the normal length limit (the block length limit on normal transactions) is 75% of the overall length limit, and the normal weight limit is 75% of the overall weight limit. </p>
<p><strong>Adjustable parameter</strong> Let <span class="math notranslate nohighlight">\(s^*\)</span> be our target block saturation level. This is our desired long-term average of the block saturation level (relative to normal txs). We originally suggest <span class="math notranslate nohighlight">\(s^*=0.25\)</span>, so that blocks are 25% full on average and the system can handle sudden spikes of up to 4x the average volume of normal transactions. This parameter can be adjusted depending on the observed volumes during spikes compared to average volumes, and in general it provides a trade-off between higher average fees and longer transaction inclusion times during spikes.</p>
<p>Recall that a transaction fee is computed as <span class="math notranslate nohighlight">\(fee(tx) = c_{traffic} \cdot length(tx) + type(tx)\cdot weight(tx)\)</span>, for a parameter <span class="math notranslate nohighlight">\(c_{traffic}\)</span> that is independent of the transaction. Let <span class="math notranslate nohighlight">\(s\)</span> be the saturation level of the current block. If <span class="math notranslate nohighlight">\(s&gt;s^*\)</span> we slightly increase <span class="math notranslate nohighlight">\(c_{traffic}\)</span>, and if <span class="math notranslate nohighlight">\(s&lt;s^*\)</span> we slightly decrease it.</p>
<p><strong>Adjustable parameter:</strong> Let <span class="math notranslate nohighlight">\(v\)</span> be a fee variability factor, which controls how quickly the transaction fees adjust. We update <span class="math notranslate nohighlight">\(c_{traffic}\)</span> from one block to the next as follows:</p>
<div class="math notranslate nohighlight">
\[c_{traffic} \leftarrow c_{traffic}\cdot (1+ v(s-s^*) + v^2(s-s^*)^2/2).\]</div>
<p>This is thus a feedback loop with multiplicative weight updates. It is a very good approximation to using the more involved update <span class="math notranslate nohighlight">\(c_{traffic} \leftarrow c_{traffic}\cdot e^{v(s-s^*)}\)</span>, which in turn has the following properties:</p>
<ul class="simple">
<li><p>Assuming that <span class="math notranslate nohighlight">\(v\)</span> is small, the relative change of parameter <span class="math notranslate nohighlight">\(c_{traffic}\)</span> is approximately proportional to the difference <span class="math notranslate nohighlight">\((s-s^*)\)</span>, i.e.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\frac{c_{traffic}^{new} - c_{traffic}^{old}}{c_{traffic}^{old}}\approx v(s-s^*).\]</div>
<ul class="simple">
<li><p>If there is a period of time during which <span class="math notranslate nohighlight">\(k\)</span> blocks are produced and the average saturation level is <span class="math notranslate nohighlight">\(s_{average}\)</span>, the relative change of parameter <span class="math notranslate nohighlight">\(c_{traffic}\)</span> during this period is approximately proportional to <span class="math notranslate nohighlight">\(k\)</span> times the difference <span class="math notranslate nohighlight">\((s_{average} - s^*)\)</span>, i.e.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\frac{c_{traffic}^{final} - c_{traffic}^{initial}}{c_{traffic}^{initial}}\approx vk(s_{average}-s^*).\]</div>
<p>How to choose the variability factor <span class="math notranslate nohighlight">\(v\)</span>? Suppose that we decide that the fees should not change by more than a fraction <span class="math notranslate nohighlight">\(p\)</span> during a period of <span class="math notranslate nohighlight">\(k\)</span> blocks, even if there is 100% saturation in that period. We obtain the formula</p>
<div class="math notranslate nohighlight">
\[ \text{fees relative change} \leq \frac{c_{traffic}^{final} - c_{traffic}^{initial}}{c_{traffic}^{initial}}\approx vk(s_{average}-s^*) \leq vk(1-s^*)\leq p,\]</div>
<p>which gives us the bound <span class="math notranslate nohighlight">\(v\leq \frac{p}{k(1-s^*)}\)</span>.</p>
<p>For instance, suppose that we detect that during peak times some transactions have to wait for up to <span class="math notranslate nohighlight">\(k=20\)</span> blocks to be included, and we consider it unfair to the user if the fees increase by more than 5% <span class="math notranslate nohighlight">\((p=0.05)\)</span> during that period. If <span class="math notranslate nohighlight">\(s^*=0.25\)</span> then the formula above gives <span class="math notranslate nohighlight">\(v\leq 0.05/[20(1-0.25)]\approx 0.0033\)</span>.</p>


<h4 id="-2.-slow-adjusting-mechanism">2. Slow adjusting mechanism<a class="headerlink" href="#-2.-slow-adjusting-mechanism" title="Permalink to this headline">¶</a></h4>
<p>In this mechanism, fees stay almost constant during short periods, adjusting only to long-term tendencies. We accept the fact that during spikes there will be long inclusion times, and allow the transactions to include tips to create a market for preferential inclusion.</p>
<p>We use the same formula as above to update the transaction fees in each block, i.e. <span class="math notranslate nohighlight">\(c_{traffic} \leftarrow c_{traffic}\cdot (1 + v(s-s^*) + v^2(s-s^*)^2/2\)</span>, except that we select a much smaller variability factor <span class="math notranslate nohighlight">\(v\)</span>. For instance, suppose that we want the fees to change by at most 30% per day, and there are around <span class="math notranslate nohighlight">\(k=14000\)</span> blocks produced in a day. If <span class="math notranslate nohighlight">\(s^*=0.25\)</span> then we obtain <span class="math notranslate nohighlight">\(v\leq 0.3/[14000(1-0.25)] = 0.00003\)</span>.</p>
<p>The transaction fee is considered a base price. There will be a different field in the transaction called tip, and a user is free to put any amount of tokens in it or leave it at zero. Block producers receive 100% of the tip on top of the standard 20% of the fee, so they have an incentive to include transactions with large tips. There should be a piece of software that gives live suggestions to users for tip values, that depend on the market conditions and the size of the transaction; it should suggest no tip most of the time.</p>




<h2 id="treasury">Treasury<a class="headerlink" href="#treasury" title="Permalink to this headline">¶</a></h2>
<p>The system needs to continually raise funds, which we call the treasury. These funds are used to pay for developers that provide software updates, apply any changes decided by referenda, adjust parameters, and generally keep the system running smoothly.</p>
<p>Funds for treasury are raised in two ways:</p>
<ol class="simple">
<li><p>by minting new tokens, leading to inflation, and</p></li>
<li><p>by channelling the tokens from transaction fees and slashings, which would otherwise be set for burning.</p></li>
</ol>
<p>Notice that these methods to raise funds mimic the traditional ways that governements raise funds: by minting coins which leads to controlled inflation, and by collecting taxes and fines.</p>
<p>We could raise funds solely from minting new tokens, but we argue that it makes sense to redirect into treasure the tokens from tx fees and slashing that would otherwise be burned:</p>
<ul class="simple">
<li><p>By doing so we reduce the amount of actual stake burning, and this gives us better control over the inflation rate (notice that stake burning leads to deflation, and we can’t control or predict the events that lead to burning).</p></li>
<li><p>Following an event that produced heavy stake slashing, goverance might often want to reimburse the slashed stake partially, if there is a bug in the code or there are extenuating circumstances. Thus it makes sense to have the DOTs availabe in treasury, instead of burning and then minting.</p></li>
<li><p>Suppose that there is a period in which there is an unusually high amount of stake burning, due to either misconducts or transaction fees. This fact is a symptom that there is something wrong with the system, that needs fixing. Hence, this will be precisely a period when we need to have more funds available in treasury to afford the development costs to fix the problem.</p></li>
</ul>
<p>–
Additional notes</p>
<p>Finality gadget <a class="reference external" href="https://github.com/w3f/consensus/blob/master/pdf/grandpa.pdf">GRANDPA</a></p>
<p>The <a class="reference external" href="Availability_and_Validity.html">availability scheme</a></p>
<p>Block production protocol <a class="reference external" href="BABE/Babe.html">BABE</a></p>
<p><a class="reference external" href="Availability_and_Validity.html">Parachain Validity</a> scheme</p>
<p>The <a class="reference external" href="NPoS/index.html">NPoS scheme</a> for selecting validators</p>




          </article>
        </div>
      </div>
    </main>
    <footer class="md-footer">
      <div class="md-footer-nav">
        <nav class="md-footer-nav__inner md-grid">
            
              <a href="Polkadot-Runtime-Environment.html" title="Material"
                 class="md-flex md-footer-nav__link md-footer-nav__link--prev"
                 rel="prev">
                <div class="md-flex__cell md-flex__cell--shrink">
                  <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
                </div>
                <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                  <span class="md-flex__ellipsis">
                    <span
                        class="md-footer-nav__direction"> Previous </span> Polkadot Runtime Environment Specification </span>
                </div>
              </a>
            
            
              <a href="BABE.html" title="Admonition"
                 class="md-flex md-footer-nav__link md-footer-nav__link--next"
                 rel="next">
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                  class="md-flex__ellipsis"> <span
                  class="md-footer-nav__direction"> Next </span> BABE </span>
              </div>
              <div class="md-flex__cell md-flex__cell--shrink"><i
                  class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
              </div>
            
          </a>
          
        </nav>
      </div>
      <div class="md-footer-meta md-typeset">
        <div class="md-footer-meta__inner md-grid">
          <div class="md-footer-copyright">
              <div class="md-footer-copyright__highlight">
                &#169; Copyright 2019, Web3 Foundation.
                
            </div>
              Created using
                <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
               and
              <a href="https://github.com/bashtage/sphinx-material/">Material for
                Sphinx</a></div>
        </div>
      </div>
    </footer>
      <script src="../_static/javascripts/application.js"></script>
      <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </div>
  </body>
</html>